source("~/GitHub/projet_ENS/Analyse Landemarais/Script Calcule Indices Biodiversité.R", echo=TRUE)
View(final.Hill)
View(final.Shannon)
View(final.Simpson)
## Importation des données
Shannon <- read.csv("Landemarais Shannon.csv")
## Importation des données
Shannon <- read.csv("Landemarais Shannon.csv")
View(Shannon)
## Importation des données
Shannon <- read.csv("Landemarais Shannon.csv")
Simpson <- read.csv("Landemarais Simpson.csv")
Hill <- read.csv("Landemarais Hill.csv")
## Imputation des NAs
library(missMDA)
?missMDA
impute.Shannon <- imputePCA(Shannon, ncp = 2)
View(impute.Shannon)
impute.Shannon <- imputePCA(Shannon, ncp = 2)$completeObs
## Importation des données
Shannon <- read.csv("Landemarais Shannon.csv")[,-1]
Simpson <- read.csv("Landemarais Simpson.csv")[,-1]
Hill <- read.csv("Landemarais Hill.csv")[,-1]
impute.Shannon <- imputePCA(Shannon, ncp = 2)$completeObs
View(Shannon)
impute.Shannon <- as.data.frame(imputePCA(Shannon, ncp = 2)$completeObs)
View(Shannon)
View(impute.Shannon)
impute.Simpson <- as.data.frame(imputePCA(Simpson, ncp = 2)$completeObs)
impute.Hill <- as.data.frame(imputePCA(Hill, ncp = 2)$completeObs)
?write.csv
# Exportation des données
write.csv(impute.Shannon, "Imputed Landemarais Shannon.csv", row.names = TRUE, col.names = TRUE)
write.csv(impute.Simpson, "Imputed Landemarais Simpson.csv", row.names = TRUE, col.names = TRUE)
write.csv(impute.Hill, "Imputed Landemarais Hill.csv", row.names = TRUE, col.names = TRUE)
# Exportation des données
write.csv(impute.Shannon, "Imputed Landemarais Shannon.csv", row.names = TRUE)
write.csv(impute.Simpson, "Imputed Landemarais Simpson.csv", row.names = TRUE)
write.csv(impute.Hill, "Imputed Landemarais Hill.csv", row.names = TRUE)
## Importation des données
Shannon <- read.csv("Imputed Landemarais Shannon.csv")
## Importation des données
Shannon <- read.csv("Imputed Landemarais Shannon.csv")
View(Shannon)
?read.csv
## Importation des données
Shannon <- read.csv("Imputed Landemarais Shannon.csv", row.names = TRUE)
View(Shannon)
## Importation des données
Shannon <- read.csv("Imputed Landemarais Shannon.csv")[,-1]
Simpson <- read.csv("Imputed Landemarais Simpson.csv")[,-1]
Hill <- read.csv("Imputed Landemarais Hill.csv")[,-1]
View(Hill)
## Représentation graphique des données
library(ggplot2)
## Shannon
ggplot(Indices,aes(x=Date,y=Shannon,group=Placette,col=Placette)) +
geom_point() +
geom_line() +
theme_classic()
library(reshape2)
View(Hill)
# Ajustement des tableaux de données
Shannon.plot <- melt(Shannon, id.vars = "Placette", variable.name = "Année", value.name = "Indice")
View(Shannon.plot)
Shannon
# Ajustement des tableaux de données
Shannon.plot <- melt(Shannon, id.vars = "Placette", variable.name = "Année", value.name = "Indice")
Simpson.plot <- melt(Simpson, id.vars = "Placette", variable.name = "Année", value.name = "Indice")
Hill.plot <- melt(Hill, id.vars = "Placette", variable.name = "Année", value.name = "Indice")
## Shannon
ggplot(Indices,aes(x=Année,y=Indice,group=Placette,col=Placette)) +
geom_point() +
geom_line() +
theme_classic()
## Shannon
ggplot(Shannon,aes(x=Année,y=Indice,group=Placette,col=Placette)) +
geom_point() +
geom_line() +
theme_classic()
source("~/.active-rstudio-document", echo=TRUE)
# Shannon
ggplot(Shannon, aes(x = Année, y = Indice)) +
geom_boxplot(aes(color = Date)) +
ggtitle("Évolution de l'indice de diversité de Shannon") +
theme_minimal() +
theme(legend.position = "none")
# Shannon
ggplot(Shannon, aes(x = Année, y = Indice)) +
geom_boxplot(aes(color = Année)) +
ggtitle("Évolution de l'indice de diversité de Shannon") +
theme_minimal() +
theme(legend.position = "none")
# Shannon
ggplot(Shannon.plot, aes(x = Année, y = Indice)) +
geom_boxplot(aes(color = Année)) +
ggtitle("Évolution de l'indice de diversité de Shannon") +
theme_minimal() +
theme(legend.position = "none")
# Simpson
ggplot(Simpson.plot, aes(x = Année, y = Indice)) +
geom_boxplot(aes(color = Année)) +
ggtitle("Évolution de l'indice de diversité de Simpson") +
theme_minimal() +
theme(legend.position = "none")
# Hill
ggplot(Hill.plot, aes(x = Année, y = Indice)) +
geom_boxplot(aes(color = Année)) +
ggtitle("Évolution de l'indice de diversité de Hill") +
theme_minimal() +
theme(legend.position = "none")
# Analyses statistiques ---------------------------------------------------
# Shannon
mod <- aov(Indice ~ Annee, data = Shannon.plot)
# Analyses statistiques ---------------------------------------------------
# Shannon
mod <- aov(Indice ~ Année, data = Shannon.plot)
summary(mod)
# Analyses statistiques ---------------------------------------------------
# Shannon
mod <- aov(Indice ~ Année + Error(Placette/Annee), data = Shannon.plot)
# Analyses statistiques ---------------------------------------------------
# Shannon
mod <- aov(Indice ~ Année + Error(Placette/Année), data = Shannon.plot)
summary(mod)
# Vérification de la normalité des individus ------------------------------
# Shannon
Shannon.plot %>%
group_by(Année) %>%
shapiro_test(Indice)
# Vérification de la normalité des individus ------------------------------
library(tidyverse)
# Shannon
Shannon.plot %>%
group_by(Année) %>%
shapiro_test(Indice)
library(rstatix)
# Shannon
Shannon.plot %>%
group_by(Année) %>%
shapiro_test(Indice)
# Simpson
Simpson.plot %>%
group_by(Année) %>%
shapiro_test(Indice)
# Simpson
ggplot(Simpson.plot, aes(x = Année, y = Indice)) +
geom_boxplot(aes(color = Année)) +
ggtitle("Évolution de l'indice de diversité de Simpson") +
theme_minimal() +
theme(legend.position = "none")
# Statistiques descriptives -----------------------------------------------
## Avec NAs
# Shannon
Shannon %>%
group_by(Année) %>%
get_summary_stats(Indice, type = "mean_sd")
# Importation des données -------------------------------------------------
Shannon <- read.csv("Landemarais Shannon.csv")[,-1]
Simpson <- read.csv("Landemarais Simpson.csv")[,-1]
Hill <- read.csv("Landemarais Hill.csv")[,-1]
# Imputation des NAs ------------------------------------------------------
library(missMDA)
impute.Shannon <- as.data.frame(imputePCA(Shannon, ncp = 2)$completeObs)
impute.Simpson <- as.data.frame(imputePCA(Simpson, ncp = 2)$completeObs)
impute.Hill <- as.data.frame(imputePCA(Hill, ncp = 2)$completeObs)
# Reshape des dataframes --------------------------------------------------
Shannon.rs <- melt(Shannon, id.vars = "Placette", variable.name = "Année", value.name = "Indice")
Simpson.rs <- melt(Simpson, id.vars = "Placette", variable.name = "Année", value.name = "Indice")
Hill.rs <- melt(Hill, id.vars = "Placette", variable.name = "Année", value.name = "Indice")
View(Shannon.rs)
View(Hill.rs)
# Importation des données -------------------------------------------------
Shannon <- read.csv("Landemarais Shannon.csv")[,-1]
Simpson <- read.csv("Landemarais Simpson.csv")[,-1]
Hill <- read.csv("Landemarais Hill.csv")[,-1]
# Imputation des NAs ------------------------------------------------------
library(missMDA)
impute.Shannon <- as.data.frame(imputePCA(Shannon, ncp = 2)$completeObs)
impute.Simpson <- as.data.frame(imputePCA(Simpson, ncp = 2)$completeObs)
impute.Hill <- as.data.frame(imputePCA(Hill, ncp = 2)$completeObs)
# Reshape des dataframes --------------------------------------------------
Shannon.rs <- melt(Shannon, id.vars = "Placette", variable.name = "Année", value.name = "Indice")
Simpson.rs <- melt(Simpson, id.vars = "Placette", variable.name = "Année", value.name = "Indice")
Hill.rs <- melt(Hill, id.vars = "Placette", variable.name = "Année", value.name = "Indice")
## Sans NAs
impute.Shannon.rs <- melt(impute.Shannon, id.vars = "Placette", variable.name = "Année", value.name = "Indice")
impute.Simpson.rs <- melt(impute.Simpson, id.vars = "Placette", variable.name = "Année", value.name = "Indice")
impute.Hill.rs <- melt(impute.Hill, id.vars = "Placette", variable.name = "Année", value.name = "Indice")
# Statistiques descriptives -----------------------------------------------
## Avec NAs
# Shannon
Shannon.rs %>%
group_by(Année) %>%
get_summary_stats(Indice, type = "mean_sd")
# Simpson
Simpson.rs %>%
group_by(Année) %>%
get_summary_stats(Indice, type = "mean_sd")
# Analyses statistiques ---------------------------------------------------
# Shannon
mod <- aov(Indice ~ Année + Error(Placette/Année), data = Shannon.rs)
summary(mod)
# Statistiques descriptives -----------------------------------------------
## Shannon
# Avec NAs
Shannon.rs %>%
group_by(Année) %>%
get_summary_stats(Indice, type = "mean_sd")
# Sans NAs
impute.Shannon.rd %>%
group_by(Année) %>%
get_summary_stats(Indice, type = "mean_sd")
# Sans NAs
impute.Shannon.rs %>%
group_by(Année) %>%
get_summary_stats(Indice, type = "mean_sd")
## Simpson
# Avec NAs
Simpson.rs %>%
group_by(Année) %>%
get_summary_stats(Indice, type = "mean_sd")
# Sans NAs
impute.Simpson.rs %>%
group_by(Année) %>%
get_summary_stats(Indice, type = "mean_sd")
# Statistiques descriptives -----------------------------------------------
## Shannon
# Avec NAs
Shannon.rs %>%
group_by(Année) %>%
get_summary_stats(Indice, type = "mean_sd")
# Sans NAs
impute.Shannon.rs %>%
group_by(Année) %>%
get_summary_stats(Indice, type = "mean_sd")
## Simpson
# Avec NAs
Simpson.rs %>%
group_by(Année) %>%
get_summary_stats(Indice, type = "mean_sd")
# Sans NAs
impute.Simpson.rs %>%
group_by(Année) %>%
get_summary_stats(Indice, type = "mean_sd")
## Hill
# Avec NAs
Hill.rs %>%
group_by(Année) %>%
get_summary_stats(Indice, type = "mean_sd")
# Sans NAs
impute.Hill.rs %>%
group_by(Année) %>%
get_summary_stats(Indice, type = "mean_sd")
# Statistiques descriptives -----------------------------------------------
## Shannon
# Avec NAs
mean.Shannon1 <- Shannon.rs %>%
group_by(Année) %>%
get_summary_stats(Indice, type = "mean_sd")
View(mean.Shannon1)
View(impute.Shannon)
# Test de la significativité des changements de moyennes ------------------
# Pour Shannon
for (i in 2:ncol(Shannon)) {
wilcox.test(Shannon[,i],impute.Shannon[,i])
}
# Test de la significativité des changements de moyennes ------------------
# Pour Shannon
for (i in 2:ncol(Shannon)) {
print(wilcox.test(Shannon[,i],impute.Shannon[,i]))
}
View(Shannon.rs)
# Comparaisons graphiques -------------------------------------------------
## Combinaison des dataframes
# Shannon
bind.shannon <- rbind(Shannon.rs, impute.Shannon.rs)
View(bind.shannon)
# Comparaisons graphiques -------------------------------------------------
## Combinaison des dataframes
# Shannon
Shannon.rs$Imputed <- rep("FALSE",nrow(Shannon.rs))
imputed.Shannon.rs$Imputed <- rep("TRUE",nrow(imputed.Shannon.rs))
impute.Shannon.rs$Imputed <- rep("TRUE",nrow(imputed.Shannon.rs))
impute.Shannon.rs$Imputed <- rep("TRUE",nrow(impute.Shannon.rs))
bind.shannon <- rbind(Shannon.rs, impute.Shannon.rs)
View(bind.shannon)
# Simpson
Simpson.rs$Imputed <- rep("FALSE",nrow(Simpson.rs))
impute.Simpson.rs$Imputed <- rep("TRUE",nrow(impute.Simpson.rs))
bind.Simpson <- rbind(Simpson.rs, impute.Simpson.rs)
bind.Shannon <- rbind(Shannon.rs, impute.Shannon.rs)
## Nested categorical boxplot
#Shannon
ggplot(bind.Shannon, aes(x = Année, y = Indice, fill = Imputed)) +
geom_boxplot() +
labs(title = "Nested Categorical Boxplot", x = "Category", y = "Value") +
theme_minimal()
# Simpson
ggplot(bind.Simpson, aes(x = Année, y = Indice, fill = Imputed)) +
geom_boxplot() +
labs(title = "Nested Categorical Boxplot", x = "Category", y = "Value") +
theme_minimal()
# Hill
ggplot(bind.Hill, aes(x = Année, y = Indice, fill = Imputed)) +
geom_boxplot() +
labs(title = "Nested Categorical Boxplot", x = "Category", y = "Value") +
theme_minimal()
# Hill
Hill.rs$Imputed <- rep("FALSE",nrow(Hill.rs))
impute.Hill.rs$Imputed <- rep("TRUE",nrow(impute.Hill.rs))
bind.Hill <- rbind(Hill.rs, impute.Hill.rs)
# Hill
ggplot(bind.Hill, aes(x = Année, y = Indice, fill = Imputed)) +
geom_boxplot() +
labs(title = "Nested Categorical Boxplot", x = "Category", y = "Value") +
theme_minimal()
